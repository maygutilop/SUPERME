<head>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.1/css/all.css">
</head>

<div class="profile-container">
  <div class="profile-info">
    <div class="profile-info-img">
    <%=  image_tag "https://media.istockphoto.com/vectors/pinup-girl-wearing-sunglasses-vector-id1183718628", class: "avatar-profile", data: { bs_toggle: "dropdown" }, 'aria-haspopup': true, 'aria-expanded': false %>
    </div>
    <div class="profile-info-text-container">
      <div class="profile-info-text">
        <h1><%= current_user.username %></h1>
        <p> <%= current_user.email %> </p>
      </div>
    </div>
  </div>
  <div class="divider">
    <hr style="width: 85%;">
  </div>
  <h2 class="bookings-header">Your bookings</h2>


  <% if @bookings.empty? %>
    <div class="profile-bookings">
      <p>You don't have any bookings</p>
    </div>
  <% else %>
    <div class="profile-bookings">
      <ul>
        <% current_user.bookings.each do |booking| %>
          <% @duration = (((booking.end_date - booking.start_date).to_i + 1)) %>
          <li>
            <div class="profile-bookings-card">
              <%= cl_image_tag booking.superpower.photo.key, height: 300, width: 400, crop: :fill %>
              <div class="profile-bookings-card-info">
                  <h4> <%= booking.superpower.name %> </h4>
                <p><strong>Start date:</strong> <%= booking.start_date %>
                <br>
                <strong>End date:</strong> <%= booking.end_date %>
                <br>
                <strong>Total price:</strong> <%= ((booking.superpower.price.to_i) * @duration).to_i %> â‚¬
                <br>
                <%# <i class="fa fa-trash"></i> %>
                </p>
              </div>
            </div>
          </li>
      </ul>
    </div>

      <% if @reviews.empty? %>
        <p>Please leave a review</p>
      <% else %>
        <% @reviews.each do |review| %>
          <p><%= review.content %><br>
          <%= review.rating %></p>
        <% end %>
      <% end %>
    <br>

        <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" style="width: fit-content">
      Leave a review
    </button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Review</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <%= simple_form_for [ booking, @review ] do |form| %>
            <%= form.input :content, as: :string %>
            <%= form.input :rating, as: :integer %>
            <%= form.submit "create review", class:"btn-primary" %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
<% end %>
</div>

